<h2>上传游戏配置文件</h2>

<div class="form-container">
  <label>
    选择文件：
    <input type="file" (change)="onFileSelected($event)" />
  </label>

  <ng-container *ngIf="data">
    <h3>分类</h3>
    <div class="category-list">
      <div
        *ngFor="let category of data.categories; let i = index"
        class="category-item"
      >
        <input [(ngModel)]="data.categories[i]" />
        <span class="delete-btn" (click)="removeCategory(i)">×</span>
      </div>
      <button (click)="addCategory()">添加分类</button>
    </div>

    <h3>游戏列表</h3>

    <input
      [(ngModel)]="gameSearch"
      placeholder="搜索游戏（支持关键字）"
      style="margin-bottom: 16px; max-width: 300px; padding: 6px 12px"
    />

    <div *ngFor="let game of filteredGames(); let gi = index" class="game-card">
      <label>游戏名：<input [(ngModel)]="game.name" /></label>
      <label>封面图：<input [(ngModel)]="game.image" /></label>
      <label>视频地址：<input [(ngModel)]="game.video" /></label>
      <label>关键字：<input [(ngModel)]="game.searchKeywords" /></label>
      <label>跳转链接：<input [(ngModel)]="game.path" /></label>
      <label
        >发布日期：<input type="date" [(ngModel)]="game.releaseDate"
      /></label>
      <label>描述：</label>
      <textarea
        [(ngModel)]="game.description"
        rows="3"
        style="width: 100%"
      ></textarea>

      <h4>详情图</h4>
      <div
        *ngFor="let img of game.imagesForDetail; let ii = index"
        class="swiper-item"
      >
        <input [(ngModel)]="game.imagesForDetail[ii]" />
        <button (click)="removeImage(game, ii)">删除</button>
      </div>
      <button (click)="addImage(game)">添加详情图</button>

      <h4>标签</h4>
      <div *ngFor="let tag of game.tags; let ti = index" class="swiper-item">
        <input [(ngModel)]="game.tags[ti]" />
        <button (click)="removeTag(game, ti)">删除</button>
      </div>
      <button (click)="addTag(game)">添加标签</button>

      <h4>类型</h4>
      <div *ngFor="let genre of game.genres; let gi = index" class="genre-item">
        <label>ID：<input [(ngModel)]="genre.id" /></label>
        <label>名称：<input [(ngModel)]="genre.name" /></label>
        <label>描述：<input [(ngModel)]="genre.description" /></label>
        <button (click)="removeGenre(game, gi)">删除类型</button>
      </div>
      <button (click)="addGenre(game)">添加类型</button>

      <h4>攻略</h4>
      <div
        *ngFor="let guide of game.guides; let gui = index"
        class="genre-item"
      >
        <label>标题：<input [(ngModel)]="guide.title" /></label>
        <label>描述：<input [(ngModel)]="guide.description" /></label>
        <label>作者：<input [(ngModel)]="guide.author" /></label>
        <label>链接：<input [(ngModel)]="guide.sourceUrl" /></label>
        <button (click)="removeGuide(game, gui)">删除攻略</button>
      </div>
      <button (click)="addGuide(game)">添加攻略</button>

      <button (click)="removeGame(gi)" style="background-color: #dc3545">
        删除此游戏
      </button>
      <hr />
    </div>

    <button (click)="addGame()">添加新游戏</button>
    <hr />
    <button (click)="download()">下载为 games.js</button>
  </ng-container>
</div>
