<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Add Image File</title>
</head>
<body>
<h1>Add Image File</h1>
<!-- WarhammerClassifier 下拉框 -->
<select id="warhammerClassifierSelect" onchange="selectWarhammerClassifier()">
  <option value="">请选择WarhammerClassifier</option>
  <option value="Beastmen">野兽人</option>
  <option value="Bretonnia">巴托尼亚</option>
  <!-- 其他 WarhammerClassifier 选项 -->
</select>


<form id="imageForm">
  <input type="hidden" id="warhammerClassifierId" name="warhammerClassifierId">

  <div>
    <label for="id">ID:</label>
    <input type="text" id="id" name="id">
  </div>
  <div>
    <label for="name">Name:</label>
    <input type="text" id="name" name="name">
  </div>
  <div>
    <label for="nameCN">Chinese Name:</label>
    <input type="text" id="nameCN" name="nameCN">
  </div>
  <div>
    <label for="path">Path:</label>
    <input type="text" id="path" name="path">
  </div>
  <div>
    <label for="heroName">Hero Name:</label>
    <input type="text" id="heroName" name="heroName">
  </div>
  <div>
    <label for="heroNameEN">Hero Name (EN):</label>
    <input type="text" id="heroNameEN" name="heroNameEN">
  </div>
  <div>
    <label for="heroAvatarPath">Hero Avatar Path:</label>
    <input type="text" id="heroAvatarPath" name="heroAvatarPath">
  </div>
  <div>
    <label for="description">Description:</label>
    <textarea id="description" name="description"></textarea>
  </div>
  <div>
    <input type="file" id="imageFileInput" accept="image/*" name="imageFile">
  </div>
  <button type="button" onclick="submitImage()">Submit</button>
</form>

<hr>

<h1>Image File Query</h1>
<button onclick="queryImageFiles()">Query Image Files</button>
<ul id="imageFileList"></ul>

<script>
  // 当选择WarhammerClassifier时，更新warhammerClassifierIdInput的值
  function selectWarhammerClassifier() {
    var selectElement = document.getElementById('warhammerClassifierSelect');
    var selectedOption = selectElement.options[selectElement.selectedIndex];
    var warhammerClassifierId = selectedOption.value;

    // 将选择的WarhammerClassifier的ID设置到warhammerClassifierIdInput中
    document.getElementById('warhammerClassifierId').value = warhammerClassifierId;
  }

  function submitImage() {
    var formData = new FormData();
    formData.append('warhammerClassifierId', document.getElementById('warhammerClassifierId').value);
    formData.append('id', document.getElementById('id').value);
    formData.append('name', document.getElementById('name').value);
    formData.append('nameCN', document.getElementById('nameCN').value);
    formData.append('path', document.getElementById('path').value);
    formData.append('heroName', document.getElementById('heroName').value);
    formData.append('heroNameEN', document.getElementById('heroNameEN').value);
    formData.append('heroAvatarPath', document.getElementById('heroAvatarPath').value);
    formData.append('description', document.getElementById('description').value);
    formData.append('imageFile', document.getElementById('imageFileInput').files[0]);

    fetch('http://localhost:8080/imageFile/saveImageFile', {
      method: 'POST',
      body: formData
    })
      .then(response => response.json())
      .then(data => {
        console.log('Image uploaded:', data);
        alert('Image uploaded successfully!');
        document.getElementById('imageForm').reset();
      })
      .catch(error => {
        console.error('Error uploading image:', error);
        alert('Error uploading image!');
      });
  }

  function queryImageFiles() {
    fetch('http://localhost:8080/imageFile/findAll')
      .then(response => response.json())
      .then(data => {
        console.log('Image files:', data);
        displayImageFiles(data);
      })
      .catch(error => {
        console.error('Error querying image files:', error);
        alert('Error querying image files!');
      });
  }

  function displayImageFiles(imageFiles) {
    var imageFileList = document.getElementById('imageFileList');
    imageFileList.innerHTML = '';

    imageFiles.forEach(function(imageFile) {
      var listItem = document.createElement('li');
      listItem.textContent = 'ID: ' + imageFile.id + ', Name: ' + imageFile.name;
      imageFileList.appendChild(listItem);
    });
  }
</script>
</body>
</html>
