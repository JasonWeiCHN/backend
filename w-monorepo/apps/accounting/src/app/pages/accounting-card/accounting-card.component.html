<div class="accounting-card">
  <div *ngFor="let room of rooms" [ngClass]="room.status" class="room-card">
    <div class="details">
      <h3>包间：{{ room.roomNumber }}</h3>
      <p *ngIf="room.roomType">类型：{{ room.roomType }}</p>

      <p *ngIf="!room.loading">{{ getStatusLabel(room.status) }}</p>
      <p *ngIf="room.loading">状态切换中...</p>

      <ng-container
        *ngIf="room.status === ERoomStatus.OCCUPIED && !room.loading"
      >
        <div class="time-block">
          <div class="date">{{ formatDate(room.startTime) }}</div>
          <div class="time-range">
            {{ formatTime(room.startTime) }} - {{ formatTime(room.endTime) }}
          </div>
          <div class="countdown">倒计时：{{ room.remainingTime }}</div>
        </div>
      </ng-container>
    </div>

    <div class="actions">
      <button
        *ngIf="room.status === ERoomStatus.AVAILABLE"
        (click)="openStartForm(room)"
        [disabled]="room.loading"
      >
        开台
      </button>
      <button
        *ngIf="room.status === ERoomStatus.AVAILABLE"
        (click)="setRoomStatus(room, ERoomStatus.DISABLED)"
        [disabled]="room.loading"
      >
        停用
      </button>
      <button
        *ngIf="room.status === ERoomStatus.OCCUPIED"
        (click)="editRoom(room)"
        [disabled]="room.loading"
      >
        信息修改
      </button>
      <button
        *ngIf="room.status === ERoomStatus.DISABLED"
        (click)="setRoomStatus(room, ERoomStatus.AVAILABLE)"
        [disabled]="room.loading"
      >
        启用
      </button>
    </div>
  </div>
</div>
